<nav
  class="navbar navbar-expand-lg px-4 shadow-sm custom-navbar"
  [class.bg-dark]="isDarkMode"
  [class.navbar-dark]="isDarkMode"
  [class.bg-light]="!isDarkMode"
  [class.navbar-light]="!isDarkMode"
>
  <div class="container-fluid">
    <!-- Brand -->
    <a class="navbar-brand d-flex align-items-center" routerLink="/">
      <img
        src="assets/images/logo-nobg.png"
        alt="Logo"
        class="navbar-logo me-2"
      />
    </a>

    <!-- Mobile Toggler -->
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#mainNav"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-end" id="mainNav">
      <ul class="navbar-nav align-items-lg-center gap-3">
        <ng-container *ngIf="!isLoggedIn">
          <li class="nav-item">
            <a
              class="nav-link cool-link"
              routerLink="/home"
              routerLinkActive="active"
            >
              {{ "NAV.HOME" | translate }}
            </a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link cool-link"
              routerLink="/login"
              routerLinkActive="active"
            >
              {{ "NAV.LOGIN" | translate }}
            </a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link cool-link"
              routerLink="/register"
              routerLinkActive="active"
            >
              {{ "NAV.REGISTER" | translate }}
            </a>
          </li>
        </ng-container>

        <ng-container *ngIf="isLoggedIn">
          <!-- Shared -->
          <li class="nav-item">
            <a
              class="nav-link cool-link"
              routerLink="/app/home"
              routerLinkActive="active"
            >
              {{ "NAV.HOME" | translate }}
            </a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link cool-link"
              routerLink="/app/dashboard/overview"
              routerLinkActive="active"
            >
              {{ "NAV.DASHBOARD" | translate }}
            </a>
          </li>

          <!-- ✅ Admin -->
          <li class="nav-item" *ngIf="role === 'admin'">
            <a
              class="nav-link cool-link"
              routerLink="/app/dashboard/overview"
              routerLinkActive="active"
            >
              {{ "NAV.DASHBOARD" | translate }} (Admin)
            </a>
          </li>

          <!-- ✅ Teacher -->
          <li class="nav-item" *ngIf="role === 'teacher'">
            <a
              class="nav-link cool-link"
              routerLink="/app/dashboard/teacher-overview"
              routerLinkActive="active"
            >
              {{ "NAV.DASHBOARD" | translate }} (Teacher)
            </a>
          </li>

          <!-- ✅ Student -->
          <li class="nav-item" *ngIf="role === 'student'">
            <a
              class="nav-link cool-link"
              routerLink="/app/dashboard/grades"
              routerLinkActive="active"
            >
              {{ "NAV.DASHBOARD" | translate }} (Student)
            </a>
          </li>

          <!-- ✅ Parent -->
          <li class="nav-item" *ngIf="role === 'Parent'">
            <a
              class="nav-link cool-link"
              routerLink="/app/dashboard/children-of-parent"
              routerLinkActive="active"
            >
              {{ "NAV.DASHBOARD" | translate }} (Parent)
            </a>
          </li>

          <!-- Profile -->
          <!-- <li class="nav-item">
            <a
              class="nav-link cool-link"
              routerLink="/app/profile"
              routerLinkActive="active"
            >
              {{ "NAV.PROFILE" | translate }}
            </a>
          </li> -->
        </ng-container>

        <li class="nav-item theme">
          <button
            type="button"
            (click)="toggleTheme()"
            [attr.aria-label]="
              'Current theme: ' + (isDarkMode ? 'Dark' : 'Light')
            "
          >
            <img
              [src]="
                isDarkMode
                  ? 'assets/images/LightMode_Icon.svg'
                  : 'assets/images/DarkMode_Icon.svg'
              "
              class="theme-icon"
              width="20"
              height="20"
              [alt]="
                isDarkMode ? 'Switch to light theme' : 'Switch to dark theme'
              "
            />
          </button>
        </li>

        <li class="nav-item lang-dropdown">
          <button
            class="lang-current-btn"
            type="button"
            (click)="toggleDropdown()"
            [attr.aria-label]="
              'Current language: ' +
              (currentLang === 'ar' ? 'Arabic' : 'English')
            "
            [attr.aria-expanded]="isDropdownOpen"
          >
            <img
              [src]="getCurrentFlag()"
              class="lang-flag"
              width="20"
              height="20"
              [alt]="currentLang === 'ar' ? 'Arabic flag' : 'English flag'"
            />
            <span class="lang-text">{{
              currentLang === "ar" ? "العربية" : "English"
            }}</span>
            <span class="lang-arrow">{{ isDropdownOpen ? "▲" : "▼" }}</span>
          </button>

          <div class="lang-options" [class.show]="isDropdownOpen">
            <button
              class="lang-option"
              (click)="switchLanguage('en')"
              [class.active]="currentLang === 'en'"
              type="button"
            >
              <img
                src="assets/images/united-kingdom-flag-icon.svg"
                class="lang-flag"
                width="20"
                height="20"
                alt="English"
              />
              <span>English</span>
              <span class="checkmark" *ngIf="currentLang === 'en'">✓</span>
            </button>

            <button
              class="lang-option"
              (click)="switchLanguage('ar')"
              [class.active]="currentLang === 'ar'"
              type="button"
            >
              <img
                src="assets/images/saudi-arabia-flag-icon.svg"
                class="lang-flag"
                width="20"
                height="20"
                alt="العربية"
              />
              <span>العربية</span>
              <span class="checkmark" *ngIf="currentLang === 'ar'">✓</span>
            </button>
          </div>
        </li>

        <li class="nav-item" *ngIf="isLoggedIn">
          <button class="outline-btn" (click)="logout()">
            {{ "NAV.LOGOUT" | translate }}
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>
