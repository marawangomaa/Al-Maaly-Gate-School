<div class="exam-page container py-5">
  <div class="text-center mb-5">
    <h1 class="hero-title mb-2 fs-2 fw-bold">{{ exam?.subjectName }}</h1>
    <p class="text-muted fs-5">
      <i class="bi bi-clock"></i>
      {{ exam?.start | date : "short" }} â†’ {{ exam?.end | date : "short" }}
    </p>
  </div>

  <div class="row g-4">
    <div
      class="col-12 col-md-10 mx-auto"
      *ngFor="let question of exam?.questions; let i = index"
    >
      <div class="card shadow-sm p-4">
        <h5 class="main-title mb-4 fs-5 fw-bold">
          {{ i + 1 }}. {{ question.content }}
        </h5>

        <!-- Multiple Choice -->
        <div *ngIf="question.type === 'Choices'" class="choices-list">
          <div *ngFor="let choice of question.choices" class="form-check mb-3">
            <input
              class="form-check-input fs-4"
              type="radio"
              [name]="question.id"
              [value]="choice.id"
              (change)="onSelectChoice(question.id, choice.id)"
              [id]="choice.id"
            />
            <label class="form-check-label fs-5" [for]="choice.id">
              {{ choice.text }}
            </label>
          </div>
        </div>

        <!-- Connection -->
        <div *ngIf="question.type === 'Connection'" class="row">
          <div class="col-6">
            <h6 class="fw-bold mb-3 fs-6">
              {{ "EXAM.COLUMNS.A" | translate }}
            </h6>
            <div
              *ngFor="let left of question.leftColumn || []"
              class="form-check mb-3"
            >
              <input
                type="radio"
                class="form-check-input fs-4"
                [name]="'left-' + question.id"
                [id]="left.id"
                (change)="onSelectConnectionLeft(question.id, left.id)"
              />
              <label [for]="left.id" class="form-check-label fs-5">{{
                left.text
              }}</label>
            </div>
          </div>

          <div class="col-6">
            <h6 class="fw-bold mb-3 fs-6">
              {{ "EXAM.COLUMNS.B" | translate }}
            </h6>
            <div
              *ngFor="let right of question.rightColumn || []"
              class="form-check mb-3"
            >
              <input
                type="radio"
                class="form-check-input fs-4"
                [name]="'right-' + question.id"
                [id]="right.id"
                (change)="onSelectConnectionRight(question.id, right.id)"
              />
              <label [for]="right.id" class="form-check-label fs-5">{{
                right.text
              }}</label>
            </div>
          </div>
        </div>

        <!-- Complete -->
        <div *ngIf="question.type === 'Complete'" class="mb-3">
          <input
            class="form-control form-control-lg"
            type="text"
            [id]="question.id"
            placeholder="{{ 'EXAM.PLACEHOLDER.WRITE_ANSWER' | translate }}"
            (input)="onTextChange($event, question.id)"
          />
        </div>

        <!-- True / False -->
        <div *ngIf="question.type === 'TrueOrFalse'" class="mb-3">
          <div class="form-check form-check-inline">
            <input
              class="form-check-input fs-4"
              type="radio"
              [name]="question.id"
              [value]="true"
              (change)="onTrueFalseChange(question.id, true)"
              [id]="question.id + '_true'"
            />
            <label class="form-check-label fs-5" [for]="question.id + '_true'">
              {{ "EXAM.TRUE" | translate }}
            </label>
          </div>

          <div class="form-check form-check-inline">
            <input
              class="form-check-input fs-4"
              type="radio"
              [name]="question.id"
              [value]="false"
              (change)="onTrueFalseChange(question.id, false)"
              [id]="question.id + '_false'"
            />
            <label class="form-check-label fs-5" [for]="question.id + '_false'">
              {{ "EXAM.FALSE" | translate }}
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="text-center mt-5">
    <button
      class="primary-btn px-5 py-3 fs-5"
      [disabled]="!allQuestionsAnswered() || isSubmitting"
      (click)="submitExam()"
    >
      <i
        class="bi"
        [ngClass]="isSubmitting ? 'bi-arrow-repeat spin' : 'bi-send'"
      ></i>

      {{
        isSubmitting
          ? ("EXAM.BUTTONS.SUBMITTING" | translate)
          : !answers
          ? ("EXAM.BUTTONS.ANSWER_ALL" | translate)
          : ("EXAM.BUTTONS.SUBMIT" | translate)
      }}
    </button>

    <p class="text-success mt-3 fs-5" *ngIf="message">{{ message }}</p>
  </div>
</div>
