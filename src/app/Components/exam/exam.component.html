<div class="exam-page container py-5">
  <!-- Exam Header -->
  <div class="text-center mb-5">
    <h1 class="hero-title mb-2">{{ exam?.subjectName }}</h1>
    <p class="text-muted">
      <i class="bi bi-clock"></i>
      {{ exam?.start | date : "short" }} â†’ {{ exam?.end | date : "short" }}
    </p>
  </div>

  <!-- Questions -->
  <div class="row g-4">
    <div
      class="col-12 col-md-10 mx-auto"
      *ngFor="let question of exam?.questions; let i = index"
    >
      <div class="card shadow-sm p-4">
        <h5 class="main-title mb-3">{{ i + 1 }}. {{ question.content }}</h5>

        <!-- Multiple Choice -->
        <div *ngIf="question.type === 'Choices'" class="choices-list">
          <div *ngFor="let choice of question.choices" class="form-check mb-2">
            <input
              class="form-check-input"
              type="radio"
              name="{{ question.id }}"
              [value]="choice.id"
              (change)="onSelectChoice(question.id, choice.id)"
              [id]="choice.id"
            />
            <label class="form-check-label" [for]="choice.id">
              {{ choice.text }}
            </label>
          </div>
        </div>

        <!-- True / False -->
        <div *ngIf="question.type === 'TrueOrFalse'">
          <div class="form-check form-check-inline">
            <input
              class="form-check-input"
              type="radio"
              name="{{ question.id }}"
              [value]="true"
              (change)="onTrueFalseChange(question.id, true)"
              [id]="question.id + '_true'"
            />
            <label class="form-check-label" [for]="question.id + '_true'">
              True
            </label>
          </div>

          <div class="form-check form-check-inline">
            <input
              class="form-check-input"
              type="radio"
              name="{{ question.id }}"
              [value]="false"
              (change)="onTrueFalseChange(question.id, false)"
              [id]="question.id + '_false'"
            />
            <label class="form-check-label" [for]="question.id + '_false'">
              False
            </label>
          </div>
        </div>

        <!-- Text Answer -->
        <div *ngIf="question.type === 'Text'" class="mt-3">
          <textarea
            class="form-control"
            rows="3"
            placeholder="Write your answer here..."
            (input)="onTextChange(question.id, $any($event.target).value)"
          ></textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- Submit -->
  <div class="text-center mt-5">
    <button
      class="primary-btn px-5 py-2"
      [disabled]="isSubmitting || !answers"
      (click)="submitExam()"
    >
      <i
        class="bi"
        [ngClass]="isSubmitting ? 'bi-arrow-repeat spin' : 'bi-send'"
      ></i>
      {{
        isSubmitting
          ? "Submitting..."
          : !answers
          ? "Answer all questions"
          : "Submit Exam"
      }}
    </button>

    <p class="text-success mt-3" *ngIf="message">{{ message }}</p>
  </div>
</div>
